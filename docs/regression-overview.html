<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Statistical Learning with R</title>
  <meta name="description" content="Statistical Learning with R">
  <meta name="generator" content="bookdown 0.7 and GitBook 2.6.7">

  <meta property="og:title" content="Statistical Learning with R" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="http://teazrq.github.io/SLWR/" />
  
  
  <meta name="github-repo" content="teazrq/SLWR" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Statistical Learning with R" />
  
  
  

<meta name="author" content="Ruoqing Zhu">


<meta name="date" content="2018-05-16">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  <link rel="shortcut icon" href="favicon.ico" type="image/x-icon">
<link rel="prev" href="optimizations-in-r.html">

<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Statistical Learning with R</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#target-audience"><i class="fa fa-check"></i>Target Audience</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#whats-covered"><i class="fa fa-check"></i>What’s Covered?</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#acknowledgements"><i class="fa fa-check"></i>Acknowledgements</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#license"><i class="fa fa-check"></i>License</a></li>
</ul></li>
<li class="part"><span><b>I Basics Knowledge</b></span></li>
<li class="chapter" data-level="1" data-path="r-rstudio-and-r-markdown.html"><a href="r-rstudio-and-r-markdown.html"><i class="fa fa-check"></i><b>1</b> R, RStudio and R Markdown</a><ul>
<li class="chapter" data-level="1.1" data-path="r-rstudio-and-r-markdown.html"><a href="r-rstudio-and-r-markdown.html#resources-and-guides"><i class="fa fa-check"></i><b>1.1</b> Resources and Guides</a></li>
<li class="chapter" data-level="1.2" data-path="r-rstudio-and-r-markdown.html"><a href="r-rstudio-and-r-markdown.html#basic-mathematical-operations"><i class="fa fa-check"></i><b>1.2</b> Basic Mathematical Operations</a><ul>
<li class="chapter" data-level="1.2.1" data-path="r-rstudio-and-r-markdown.html"><a href="r-rstudio-and-r-markdown.html#data-objects"><i class="fa fa-check"></i><b>1.2.1</b> Data Objects</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="r-rstudio-and-r-markdown.html"><a href="r-rstudio-and-r-markdown.html#read-in-data-from-other-sources"><i class="fa fa-check"></i><b>1.3</b> Read-in Data from Other Sources</a></li>
<li class="chapter" data-level="1.4" data-path="r-rstudio-and-r-markdown.html"><a href="r-rstudio-and-r-markdown.html#using-packages"><i class="fa fa-check"></i><b>1.4</b> Using Packages</a></li>
<li class="chapter" data-level="1.5" data-path="r-rstudio-and-r-markdown.html"><a href="r-rstudio-and-r-markdown.html#using-r-markdown"><i class="fa fa-check"></i><b>1.5</b> Using R Markdown</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="basics-of-probability-and-statistics.html"><a href="basics-of-probability-and-statistics.html"><i class="fa fa-check"></i><b>2</b> Basics of Probability and Statistics</a><ul>
<li class="chapter" data-level="2.1" data-path="basics-of-probability-and-statistics.html"><a href="basics-of-probability-and-statistics.html#random-number-generation"><i class="fa fa-check"></i><b>2.1</b> Random number generation</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="modeling-basics-in-r.html"><a href="modeling-basics-in-r.html"><i class="fa fa-check"></i><b>3</b> Modeling Basics in <code>R</code></a><ul>
<li class="chapter" data-level="3.1" data-path="modeling-basics-in-r.html"><a href="modeling-basics-in-r.html#visualization-for-regression"><i class="fa fa-check"></i><b>3.1</b> Visualization for Regression</a></li>
<li class="chapter" data-level="3.2" data-path="modeling-basics-in-r.html"><a href="modeling-basics-in-r.html#sec:lm"><i class="fa fa-check"></i><b>3.2</b> The <code>lm()</code> Function</a></li>
<li class="chapter" data-level="3.3" data-path="modeling-basics-in-r.html"><a href="modeling-basics-in-r.html#hypothesis-testing"><i class="fa fa-check"></i><b>3.3</b> Hypothesis Testing</a></li>
<li class="chapter" data-level="3.4" data-path="modeling-basics-in-r.html"><a href="modeling-basics-in-r.html#prediction"><i class="fa fa-check"></i><b>3.4</b> Prediction</a></li>
<li class="chapter" data-level="3.5" data-path="modeling-basics-in-r.html"><a href="modeling-basics-in-r.html#unusual-observations"><i class="fa fa-check"></i><b>3.5</b> Unusual Observations</a></li>
<li class="chapter" data-level="3.6" data-path="modeling-basics-in-r.html"><a href="modeling-basics-in-r.html#adding-complexity"><i class="fa fa-check"></i><b>3.6</b> Adding Complexity</a><ul>
<li class="chapter" data-level="3.6.1" data-path="modeling-basics-in-r.html"><a href="modeling-basics-in-r.html#interactions"><i class="fa fa-check"></i><b>3.6.1</b> Interactions</a></li>
<li class="chapter" data-level="3.6.2" data-path="modeling-basics-in-r.html"><a href="modeling-basics-in-r.html#polynomials"><i class="fa fa-check"></i><b>3.6.2</b> Polynomials</a></li>
<li class="chapter" data-level="3.6.3" data-path="modeling-basics-in-r.html"><a href="modeling-basics-in-r.html#transformations"><i class="fa fa-check"></i><b>3.6.3</b> Transformations</a></li>
</ul></li>
<li class="chapter" data-level="3.7" data-path="modeling-basics-in-r.html"><a href="modeling-basics-in-r.html#rmarkdown"><i class="fa fa-check"></i><b>3.7</b> <code>rmarkdown</code></a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="optimizations-in-r.html"><a href="optimizations-in-r.html"><i class="fa fa-check"></i><b>4</b> Optimizations in `R’</a><ul>
<li class="chapter" data-level="4.1" data-path="optimizations-in-r.html"><a href="optimizations-in-r.html#a-simple-optimization-problem"><i class="fa fa-check"></i><b>4.1</b> A simple optimization problem</a></li>
</ul></li>
<li class="part"><span><b>II Regression</b></span></li>
<li class="chapter" data-level="5" data-path="regression-overview.html"><a href="regression-overview.html"><i class="fa fa-check"></i><b>5</b> Overview</a></li>
<li class="divider"></li>
<li><a href="https://github.com/teazrq/SLWR" target="blank">&copy; 2018 Ruoqing Zhu</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Statistical Learning with R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="regression-overview" class="section level1">
<h1><span class="header-section-number">Chapter 5</span> Overview</h1>
<p><strong>Chapter Status:</strong> This chapter is currently undergoing massive rewrites. Some code is mostly for the use of current students. Plotting code is often not best practice for plotting, but is instead useful for understanding.</p>
<ul>
<li><strong>Supervised Learning</strong>
<ul>
<li><strong>Regression</strong> (Numeric Response)
<ul>
<li>What do we want? To make <em>predictions</em> on <em>unseen data</em>. (Predicting on data we already have is easy…) In other words, we want a <em>model</em> that <strong>generalizes</strong> well. That is, generalizes to unseen data.</li>
<li>How we will do this? By controlling the <strong>complexity</strong> of the model to guard against <strong>overfitting</strong> and <strong>underfitting</strong>.
<ul>
<li>Model Parameters</li>
<li>Tuning Parameters</li>
</ul></li>
<li>Why does manipulating the model complexity accomplish this? Because there is a <strong>bias-variance tradeoff</strong>.</li>
<li>How do we know if our model generalizes? By evaluating <em>metrics</em> on <strong>test</strong> data. We will only ever fit (train) models on training data. All analyses will begin with a test-train split. For regression tasks, our metric will be <strong>RMSE</strong>.</li>
</ul></li>
<li>Classification (Categorical Response) The next section.</li>
</ul></li>
</ul>
<div class="figure">
<img src="images/regression.png" />

</div>
<p><strong>Regression</strong> is a form of <strong>supervised learning</strong>. Supervised learning deals with problems where there are both an input and an output. Regression problems are the subset of supervised learning problems with a <strong>numeric</strong> output.</p>
<p>Often one of the biggest differences between <em>statistical learning</em>, <em>machine learning</em>, <em>artificial intelligence</em> are the names used to describe variables and methods.</p>
<ul>
<li>The <strong>input</strong> can be called: input vector, feature vector, or predictors. The elements of these would be an input, feature, or predictor. The individual features can be either numeric or categorical.</li>
<li>The <strong>output</strong> may be called: output, response, outcome, or target. The response must be numeric.</li>
</ul>
<p>As an aside, some textbooks and statisticians use the terms independent and dependent variables to describe the response and the predictors. However, this practice can be confusing as those terms have specific meanings in probability theory.</p>
<p><em>Our goal is to find a rule, algorithm, or function which takes as input a feature vector, and outputs a response which is as close to the true value as possible.</em> We often write the true, unknown relationship between the input and output <span class="math inline">\(f(\bf{x})\)</span>. The relationship (model) we learn (fit, train), based on data, is written <span class="math inline">\(\hat{f}(\bf{x})\)</span>.</p>
<p>From a statistical learning point-of-view, we write,</p>
<p><span class="math display">\[
Y = f(\bf{x}) + \epsilon
\]</span></p>
<p>to indicate that the true response is a function of both the unknown relationship, as well as some unlearnable noise.</p>
<p><span class="math display">\[
\text{RMSE}(\hat{f}, \text{Data}) = \sqrt{\frac{1}{n}\displaystyle\sum_{i = 1}^{n}\left(y_i - \hat{f}(\bf{x}_i)\right)^2}
\]</span></p>
<p><span class="math display">\[
\text{RMSE}_{\text{Train}} = \text{RMSE}(\hat{f}, \text{Train Data}) = \sqrt{\frac{1}{n_{\text{Tr}}}\displaystyle\sum_{i \in \text{Train}}^{}\left(y_i - \hat{f}(\bf{x}_i)\right)^2}
\]</span></p>
<p><span class="math display">\[
\text{RMSE}_{\text{Test}} = \text{RMSE}(\hat{f}, \text{Test Data}) = \sqrt{\frac{1}{n_{\text{Te}}}\displaystyle\sum_{i \in \text{Test}}^{}\left(y_i - \hat{f}(\bf{x}_i)\right)^2}
\]</span> - TODO: RSS vs <span class="math inline">\(R^2\)</span> vs RMSE</p>
<p><strong>Code for Plotting from Class</strong></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## load packages
<span class="kw">library</span>(rpart)
<span class="kw">library</span>(FNN)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># simulate data</span>

## signal
f =<span class="st"> </span><span class="cf">function</span>(x) {
  x <span class="op">^</span><span class="st"> </span><span class="dv">3</span>
}

## define data generating processs
get_sim_data =<span class="st"> </span><span class="cf">function</span>(f, <span class="dt">sample_size =</span> <span class="dv">50</span>) {
  x =<span class="st"> </span><span class="kw">runif</span>(<span class="dt">n =</span> sample_size, <span class="dt">min =</span> <span class="op">-</span><span class="dv">1</span>, <span class="dt">max =</span> <span class="dv">1</span>)
  y =<span class="st"> </span><span class="kw">rnorm</span>(<span class="dt">n =</span> sample_size, <span class="dt">mean =</span> <span class="kw">f</span>(x), <span class="dt">sd =</span> <span class="fl">0.15</span>)
  <span class="kw">data.frame</span>(x, y)
}

## simualte training data
<span class="kw">set.seed</span>(<span class="dv">42</span>)
sim_trn_data =<span class="st"> </span><span class="kw">get_sim_data</span>(<span class="dt">f =</span> f)

## simulate testing data
<span class="kw">set.seed</span>(<span class="dv">3</span>)
sim_tst_data =<span class="st"> </span><span class="kw">get_sim_data</span>(<span class="dt">f =</span> f)

## create grid for plotting
x_grid =<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">x =</span> <span class="kw">seq</span>(<span class="op">-</span><span class="fl">1.5</span>, <span class="fl">1.5</span>, <span class="fl">0.001</span>))</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># fit models</span>

## tree models
tree_fit_l =<span class="st"> </span><span class="kw">rpart</span>(y <span class="op">~</span><span class="st"> </span>x, <span class="dt">data =</span> sim_trn_data, 
                   <span class="dt">control =</span> <span class="kw">rpart.control</span>(<span class="dt">cp =</span> <span class="fl">0.500</span>, <span class="dt">minsplit =</span> <span class="dv">2</span>))
tree_fit_m =<span class="st"> </span><span class="kw">rpart</span>(y <span class="op">~</span><span class="st"> </span>x, <span class="dt">data =</span> sim_trn_data, 
                   <span class="dt">control =</span> <span class="kw">rpart.control</span>(<span class="dt">cp =</span> <span class="fl">0.015</span>, <span class="dt">minsplit =</span> <span class="dv">2</span>))
tree_fit_h =<span class="st"> </span><span class="kw">rpart</span>(y <span class="op">~</span><span class="st"> </span>x, <span class="dt">data =</span> sim_trn_data, 
                   <span class="dt">control =</span> <span class="kw">rpart.control</span>(<span class="dt">cp =</span> <span class="fl">0.000</span>, <span class="dt">minsplit =</span> <span class="dv">2</span>))

## knn models
knn_fit_l =<span class="st"> </span><span class="kw">knn.reg</span>(<span class="dt">train =</span> sim_trn_data[<span class="st">&quot;x&quot;</span>], <span class="dt">y =</span> sim_trn_data<span class="op">$</span>y, 
                    <span class="dt">test =</span> x_grid, <span class="dt">k =</span> <span class="dv">40</span>)
knn_fit_m =<span class="st"> </span><span class="kw">knn.reg</span>(<span class="dt">train =</span> sim_trn_data[<span class="st">&quot;x&quot;</span>], <span class="dt">y =</span> sim_trn_data<span class="op">$</span>y, 
                    <span class="dt">test =</span> x_grid, <span class="dt">k =</span> <span class="dv">5</span>)
knn_fit_h =<span class="st"> </span><span class="kw">knn.reg</span>(<span class="dt">train =</span> sim_trn_data[<span class="st">&quot;x&quot;</span>], <span class="dt">y =</span> sim_trn_data<span class="op">$</span>y, 
                    <span class="dt">test =</span> x_grid, <span class="dt">k =</span> <span class="dv">1</span>)

## polynomial models
poly_fit_l =<span class="st"> </span><span class="kw">lm</span>(y <span class="op">~</span><span class="st"> </span><span class="kw">poly</span>(x,  <span class="dv">1</span>), <span class="dt">data =</span> sim_trn_data)
poly_fit_m =<span class="st"> </span><span class="kw">lm</span>(y <span class="op">~</span><span class="st"> </span><span class="kw">poly</span>(x,  <span class="dv">3</span>), <span class="dt">data =</span> sim_trn_data)
poly_fit_h =<span class="st"> </span><span class="kw">lm</span>(y <span class="op">~</span><span class="st"> </span><span class="kw">poly</span>(x, <span class="dv">22</span>), <span class="dt">data =</span> sim_trn_data)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># get predictions</span>

## tree models
tree_fit_l_pred =<span class="st"> </span><span class="kw">predict</span>(tree_fit_l, <span class="dt">newdata =</span> x_grid)
tree_fit_m_pred =<span class="st"> </span><span class="kw">predict</span>(tree_fit_m, <span class="dt">newdata =</span> x_grid)
tree_fit_h_pred =<span class="st"> </span><span class="kw">predict</span>(tree_fit_h, <span class="dt">newdata =</span> x_grid)

## knn models
knn_fit_l_pred =<span class="st"> </span>knn_fit_l<span class="op">$</span>pred
knn_fit_m_pred =<span class="st"> </span>knn_fit_m<span class="op">$</span>pred
knn_fit_h_pred =<span class="st"> </span>knn_fit_h<span class="op">$</span>pred

## polynomial models
poly_fit_l_pred =<span class="st"> </span><span class="kw">predict</span>(poly_fit_l, <span class="dt">newdata =</span> x_grid)
poly_fit_m_pred =<span class="st"> </span><span class="kw">predict</span>(poly_fit_m, <span class="dt">newdata =</span> x_grid)
poly_fit_h_pred =<span class="st"> </span><span class="kw">predict</span>(poly_fit_h, <span class="dt">newdata =</span> x_grid)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># plot fitted trees</span>

<span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">3</span>))
<span class="kw">plot</span>(y <span class="op">~</span><span class="st"> </span>x, <span class="dt">data =</span> sim_trn_data, <span class="dt">col =</span> <span class="st">&quot;dodgerblue&quot;</span>, <span class="dt">pch =</span> <span class="dv">20</span>, 
     <span class="dt">main =</span> <span class="st">&quot;Tree Model, cp = 0.5&quot;</span>, <span class="dt">cex =</span> <span class="fl">1.5</span>)
<span class="kw">grid</span>()
<span class="kw">lines</span>(x_grid<span class="op">$</span>x, tree_fit_l_pred, <span class="dt">col =</span> <span class="st">&quot;darkgrey&quot;</span>,  <span class="dt">lwd =</span> <span class="dv">2</span>)

<span class="kw">plot</span>(y <span class="op">~</span><span class="st"> </span>x, <span class="dt">data =</span> sim_trn_data, <span class="dt">col =</span> <span class="st">&quot;dodgerblue&quot;</span>, <span class="dt">pch =</span> <span class="dv">20</span>,
     <span class="dt">main =</span> <span class="st">&quot;Tree Model, cp = 0.015&quot;</span>, <span class="dt">cex =</span> <span class="fl">1.5</span>)
<span class="kw">grid</span>()
<span class="kw">lines</span>(x_grid<span class="op">$</span>x, tree_fit_m_pred, <span class="dt">col =</span> <span class="st">&quot;darkgrey&quot;</span>,  <span class="dt">lwd =</span> <span class="dv">2</span>)

<span class="kw">plot</span>(y <span class="op">~</span><span class="st"> </span>x, <span class="dt">data =</span> sim_trn_data, <span class="dt">col =</span> <span class="st">&quot;dodgerblue&quot;</span>, <span class="dt">pch =</span> <span class="dv">20</span>, 
     <span class="dt">main =</span> <span class="st">&quot;Tree Model, cp = 0.0&quot;</span>, <span class="dt">cex =</span> <span class="fl">1.5</span>)
<span class="kw">grid</span>()
<span class="kw">lines</span>(x_grid<span class="op">$</span>x, tree_fit_h_pred, <span class="dt">col =</span> <span class="st">&quot;darkgrey&quot;</span>,  <span class="dt">lwd =</span> <span class="dv">2</span>)</code></pre></div>
<p><img src="2.1-regression_files/figure-html/unnamed-chunk-5-1.png" width="960" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># plot fitted KNN</span>

<span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">3</span>))
<span class="kw">plot</span>(y <span class="op">~</span><span class="st"> </span>x, <span class="dt">data =</span> sim_trn_data, <span class="dt">col =</span> <span class="st">&quot;dodgerblue&quot;</span>, <span class="dt">pch =</span> <span class="dv">20</span>, 
     <span class="dt">main =</span> <span class="st">&quot;KNN, k = 40&quot;</span>, <span class="dt">cex =</span> <span class="fl">1.5</span>)
<span class="kw">grid</span>()
<span class="kw">lines</span>(x_grid<span class="op">$</span>x, knn_fit_l_pred, <span class="dt">col =</span> <span class="st">&quot;darkgrey&quot;</span>,  <span class="dt">lwd =</span> <span class="dv">2</span>)

<span class="kw">plot</span>(y <span class="op">~</span><span class="st"> </span>x, <span class="dt">data =</span> sim_trn_data, <span class="dt">col =</span> <span class="st">&quot;dodgerblue&quot;</span>, <span class="dt">pch =</span> <span class="dv">20</span>,
     <span class="dt">main =</span> <span class="st">&quot;KNN, k = 5&quot;</span>, <span class="dt">cex =</span> <span class="fl">1.5</span>)
<span class="kw">grid</span>()
<span class="kw">lines</span>(x_grid<span class="op">$</span>x, knn_fit_m_pred, <span class="dt">col =</span> <span class="st">&quot;darkgrey&quot;</span>,  <span class="dt">lwd =</span> <span class="dv">2</span>)

<span class="kw">plot</span>(y <span class="op">~</span><span class="st"> </span>x, <span class="dt">data =</span> sim_trn_data, <span class="dt">col =</span> <span class="st">&quot;dodgerblue&quot;</span>, <span class="dt">pch =</span> <span class="dv">20</span>, 
     <span class="dt">main =</span> <span class="st">&quot;KNN, k = 1&quot;</span>, <span class="dt">cex =</span> <span class="fl">1.5</span>)
<span class="kw">grid</span>()
<span class="kw">lines</span>(x_grid<span class="op">$</span>x, knn_fit_h_pred, <span class="dt">col =</span> <span class="st">&quot;darkgrey&quot;</span>,  <span class="dt">lwd =</span> <span class="dv">2</span>)</code></pre></div>
<p><img src="2.1-regression_files/figure-html/unnamed-chunk-6-1.png" width="960" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># plot fitted polynomials</span>
<span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">3</span>))
<span class="kw">plot</span>(y <span class="op">~</span><span class="st"> </span>x, <span class="dt">data =</span> sim_trn_data, <span class="dt">col =</span> <span class="st">&quot;dodgerblue&quot;</span>, <span class="dt">pch =</span> <span class="dv">20</span>, 
     <span class="dt">main =</span> <span class="st">&quot;Polynomial Model, degree = 1&quot;</span>, <span class="dt">cex =</span> <span class="fl">1.5</span>)
<span class="kw">grid</span>()
<span class="kw">lines</span>(x_grid<span class="op">$</span>x, poly_fit_l_pred, <span class="dt">col =</span> <span class="st">&quot;darkgrey&quot;</span>,  <span class="dt">lwd =</span> <span class="dv">2</span>)

<span class="kw">plot</span>(y <span class="op">~</span><span class="st"> </span>x, <span class="dt">data =</span> sim_trn_data, <span class="dt">col =</span> <span class="st">&quot;dodgerblue&quot;</span>, <span class="dt">pch =</span> <span class="dv">20</span>,
     <span class="dt">main =</span> <span class="st">&quot;Polynomial Model, degree = 3&quot;</span>, <span class="dt">cex =</span> <span class="fl">1.5</span>)
<span class="kw">grid</span>()
<span class="kw">lines</span>(x_grid<span class="op">$</span>x, poly_fit_m_pred, <span class="dt">col =</span> <span class="st">&quot;darkgrey&quot;</span>,  <span class="dt">lwd =</span> <span class="dv">2</span>)

<span class="kw">plot</span>(y <span class="op">~</span><span class="st"> </span>x, <span class="dt">data =</span> sim_trn_data, <span class="dt">col =</span> <span class="st">&quot;dodgerblue&quot;</span>, <span class="dt">pch =</span> <span class="dv">20</span>, 
     <span class="dt">main =</span> <span class="st">&quot;Polynomial Model, degree = 22&quot;</span>, <span class="dt">cex =</span> <span class="fl">1.5</span>)
<span class="kw">grid</span>()
<span class="kw">lines</span>(x_grid<span class="op">$</span>x, poly_fit_h_pred, <span class="dt">col =</span> <span class="st">&quot;darkgrey&quot;</span>,  <span class="dt">lwd =</span> <span class="dv">2</span>)</code></pre></div>
<p><img src="2.1-regression_files/figure-html/unnamed-chunk-7-1.png" width="960" /></p>
<!-- ## Regression Notation -->
<!-- - $\mathbf{X}$ = $n \times p$ data matrix -->
<!-- - $\mathbf{x}_j$ = column of data matrix. vector of length $n$. $n$ observations of predictors $j$. -->
<!-- - $X$ = random variable. vector of length $p$, which could be 1 (not bold) -->
<!-- - $x_i$ = predictor values for observation $i$. vector of length $p$. realization of random variable $X$. (not bold) -->
<!-- - $Y$ = random variable. scalar. (not bold) -->
<!-- - $y_i$ = response for observation $i$. scalar. realization of random variable $Y$. (not bold) -->
<!-- - $i$ is for observations, of which there are $n$ -->
<!-- - $j$ is for predictors (features), of which there are $p$ -->
<!-- - $\mathcal{D}_{\texttt{trn}}$ is training data -->
<!-- - $n_{\texttt{trn}}$ is size of training data -->
<!-- - $\mathcal{D}_{\texttt{tst}}$ is training data -->
<!-- - $n_{\texttt{tst}}$ is size of training data -->
<!-- $$ -->
<!-- (X, Y) \in \mathbb{R}^p \times \mathbb{R} -->
<!-- $$ -->
<!-- $$ -->
<!-- \mathcal{D} = (x_i, y_i) \in \mathbb{R}^p \times \mathbb{R} -->
<!-- $$ -->
<!-- $$ -->
<!-- x_i^T = [x_{i1}, x_{i2}, \ldots x_{ip}] -->
<!-- $$ -->
<!-- $$ -->
<!-- x^T = [x_{1}, x_{2}, \ldots x_{p}] -->
<!-- $$ -->
<!-- $$ -->
<!-- \mathbf{x}_j = \begin{bmatrix} x_{1j} \\ x_{2j} \\ \vdots\\ x_{nj} \end{bmatrix} -->
<!-- $$ -->
<!-- $$ -->
<!-- \mathbf{X} = [\mathbf{x}_1, \mathbf{x}_2, \ldots, \mathbf{x}_p] -->
<!-- $$ -->
<!-- $$ -->
<!-- \mathbf{X} = \begin{bmatrix} x_1^T \\ x_2^T \\ \vdots\\ x_n^T \end{bmatrix} -->
<!-- $$ -->
<!-- $$ -->
<!-- \mathbf{X} = [\mathbf{1}, \mathbf{x}_1, \mathbf{x}_2, \ldots, \mathbf{x}_p] -->
<!-- $$ -->
<!-- $$ -->
<!-- \mathbf{y} = \begin{bmatrix} y_1 \\ y_2 \\ \vdots\\ y_n \end{bmatrix} -->
<!-- $$ -->
<!-- $$ -->
<!-- \mathbb{E}[(Y - f(X))^2] -->
<!-- $$ -->
<!-- $$ -->
<!-- Y = f(X) + \epsilon -->
<!-- $$ -->
<!-- $$ -->
<!-- f(x) = \mathbb{E}(Y \mid X = x) -->
<!-- $$ -->

<div id="refs" class="references">
<div>
<p>Hastie, Trevor, Robert Tibshirani, and Jerome Friedman. 2001. <em>The Elements of Statistical Learning</em>. Vol. 1. Springer series in statistics New York.</p>
</div>
<div>
<p>James, Gareth, Daniela Witten, Trevor Hastie, and Robert Tibshirani. 2013. <em>An Introduction to Statistical Learning</em>. Vol. 112. Springer.</p>
</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="optimizations-in-r.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/teazrq/SLWR/edit/master/2.1-regression.Rmd",
"text": "Edit"
},
"download": ["RESL.pdf"],
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "";
    if (src === "" || src === "true") src = "https://cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
